      
      subroutine ensBASIS_TRIA_DRORTHO0(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else if (trp_.eq.'T') then 
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
            b_(i,1) = 0.d0
         else if (trb_.eq.'N') then 
            b_(1,i) = 0.d0
         endif
      end do
      end subroutine       

      subroutine ensBASIS_TRIA_DRORTHO1(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else if (trp_.eq.'T') then 
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 6.0d0                                                         
         b_(i,3) = 3.464101615137755d0                                           
         else if (trb_.eq.'N') then 
         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 6.0d0                                                         
         b_(3,i) = 3.464101615137755d0                                           
         endif
      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DRORTHO2(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 

       b_(i,1) = 0.0d0                                                         
       b_(i,2) = 6.0d0                                                         
       b_(i,3) = 3.464101615137755d0                                           
       b_(i,4) = 4.898979485566356d1*r-1.959591794226543d1                     
       b_(i,5) = 4.242640687119285d1*s+4.242640687119285d1*r
     1    -2.545584412271571d1                                                             
       b_(i,6) = 3.286335345030997d1*s+1.095445115010332d1*r
     1    -1.095445115010332d1                                                             
         else if (trb_.eq.'N') then 


       b_(1,i) = 0.0d0                                                         
       b_(2,i) = 6.0d0                                                         
       b_(3,i) = 3.464101615137755d0                                           
       b_(4,i) = 4.898979485566356d1*r-1.959591794226543d1                     
       b_(5,i) = 4.242640687119285d1*s+4.242640687119285d1*r
     1    -2.545584412271571d1                                                             
       b_(6,i) = 3.286335345030997d1*s+1.095445115010332d1*r
     1    -1.095445115010332d1                                                             


         endif

      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DRORTHO3(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 

         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 6.0d0                                                         
         b_(i,3) = 3.464101615137755d0                                           
         b_(i,4) = 4.898979485566356d1*r-1.959591794226543d1                     
         b_(i,5) = 4.242640687119285d1*s+4.242640687119285d1*r
     1        -2.545584412271571d1                                                             
         b_(i,6) = 3.286335345030997d1*s+1.095445115010332d1*r
     1        -1.095445115010332d1                                                             
         b_(i,7) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1        +4.242640687119285d1                                                       
         b_(i,8) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1        -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2        -9.699979381421385d2)+1.910601999370879d2)                                        
         b_(i,9) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1        -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2        -1.897366596101028d2)+5.692099788303083d1                                         
         b_(i,10) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1        r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2        -4.48998886412873d1)+2.244994432064365d1                                         
         




      else         if (trb_.eq.'N') then 

         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 6.0d0                                                         
         b_(3,i) = 3.464101615137755d0                                           
         b_(4,i) = 4.898979485566356d1*r-1.959591794226543d1                     
         b_(5,i) = 4.242640687119285d1*s+4.242640687119285d1*r
     1        -2.545584412271571d1                                                             
         b_(6,i) = 3.286335345030997d1*s+1.095445115010332d1*r
     1        -1.095445115010332d1                                                             
         b_(7,i) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1        +4.242640687119285d1                                                       
         b_(8,i) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1        -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2        -9.699979381421385d2)+1.910601999370879d2)                                        
         b_(9,i) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1        -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2        -1.897366596101028d2)+5.692099788303083d1                                         
         b_(10,i) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1        r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2        -4.48998886412873d1)+2.244994432064365d1                                         
         




      endif




      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DRORTHO4(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 


         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 6.0d0                                                         
         b_(i,3) = 3.464101615137755d0                                           
         b_(i,4) = 4.898979485566356d1*r-1.959591794226543d1                     
         b_(i,5) = 4.242640687119285d1*s+4.242640687119285d1*r
     1        -2.545584412271571d1                                                             
         b_(i,6) = 3.286335345030997d1*s+1.095445115010332d1*r
     1        -1.095445115010332d1                                                             
         b_(i,7) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1        +4.242640687119285d1                                                       
         b_(i,8) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1        -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2        -9.699979381421385d2)+1.910601999370879d2)                                        
         b_(i,9) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1        -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2        -1.897366596101028d2)+5.692099788303083d1                                         
         b_(i,10) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1        r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2        -4.48998886412873d1)+2.244994432064365d1                                         
         b_(i,11) = r*(r*(1.593787940724863d3*r        
     1        -2.125050587633151d3)+7.968939703624316d2)
     &        -7.58946638440411d1                       
         b_(i,12) = (r*(2.760521689826037d3*r        
     1        -1.840347793217358d3)+2.300434741521698d2)*s+r*(r        
     2        *(1.840347793217358d3*r-2.760521689826037d3)
     3        +1.150217370760849d3)-1.204989626511366d2                                                                
         b_(i,13) = 2.5d-1*(s*((1.221880517890354d4*r
     &        -2.71529        
     1        0039756342d3)*s+r*(1.832820776835531d4*r-1.7649385258416        
     2        22d4)+2.884995667241114d3)+r*(r*(4.072935059634513        
     3        d3*r-7.467047609329941d3)+3.903229432149742d3)
     &        -5.091168824543142d2)                                                                 
         b_(i,14) = s*(s*(1.505988047761336d3*s+4.51796414328        
     1        4008d3*r-2.509980079602227d3)+r*(2.710778485970405d3*r-3        
     2        .815169720995385d3)+1.10439123502498d3)+r*(r*(        
     3        3.011976095522672d2*r-7.027944222886235d2)
     &        +5.019960159204453d2)        
     4        -1.003992031840891d2                                                     
         b_(i,15) = 2.0d-1*(s*(s*(6.640783086353596d3*s+8.538        
     1        149682454624d3*r-8.538149682454624d3)+r*(2.8460498941515        
     2        41d3*r-5.692099788303083d3)+2.846049894151541d3)+r*(1.0d        
     3        0*r*(1.897366596101028d2*r-5.692099788303083d2)        
     4        +5.692099788303083d2)-1.897366596101028d2)                                           
         




      else          if (trb_.eq.'N') then 

         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 6.0d0                                                         
         b_(3,i) = 3.464101615137755d0                                           
         b_(4,i) = 4.898979485566356d1*r-1.959591794226543d1                     
         b_(5,i) = 4.242640687119285d1*s+4.242640687119285d1*r
     1        -2.545584412271571d1                                                             
         b_(6,i) = 3.286335345030997d1*s+1.095445115010332d1*r
     1        -1.095445115010332d1                                                             
         b_(7,i) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1        +4.242640687119285d1                                                       
         b_(8,i) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1        -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2        -9.699979381421385d2)+1.910601999370879d2)                                        
         b_(9,i) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1        -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2        -1.897366596101028d2)+5.692099788303083d1                                         
         b_(10,i) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1        r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2        -4.48998886412873d1)+2.244994432064365d1                                         
         b_(11,i) = r*(r*(1.593787940724863d3*r        
     1        -2.125050587633151d3)+7.968939703624316d2)
     &        -7.58946638440411d1                       
         b_(12,i) = (r*(2.760521689826037d3*r        
     1        -1.840347793217358d3)+2.300434741521698d2)*s+r*(r        
     2        *(1.840347793217358d3*r-2.760521689826037d3)
     3        +1.150217370760849d3)-1.204989626511366d2                                                                
         b_(13,i) = 2.5d-1*(s*((1.221880517890354d4*r
     &        -2.71529        
     1        0039756342d3)*s+r*(1.832820776835531d4*r-1.7649385258416        
     2        22d4)+2.884995667241114d3)+r*(r*(4.072935059634513        
     3        d3*r-7.467047609329941d3)+3.903229432149742d3)
     &        -5.091168824543142d2)                                                                 
         b_(14,i) = s*(s*(1.505988047761336d3*s+4.51796414328        
     1        4008d3*r-2.509980079602227d3)+r*(2.710778485970405d3*r-3        
     2        .815169720995385d3)+1.10439123502498d3)+r*(r*(        
     3        3.011976095522672d2*r-7.027944222886235d2)
     &        +5.019960159204453d2)        
     4        -1.003992031840891d2                                                     
         b_(15,i) = 2.0d-1*(s*(s*(6.640783086353596d3*s+8.538        
     1        149682454624d3*r-8.538149682454624d3)+r*(2.8460498941515        
     2        41d3*r-5.692099788303083d3)+2.846049894151541d3)+r*(1.0d        
     3        0*r*(1.897366596101028d2*r-5.692099788303083d2)        
     4        +5.692099788303083d2)-1.897366596101028d2)                                           
         





      endif




      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DRORTHO5(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)

      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 

       b_(i,1) = 0.0d0                                                         
       b_(i,2) = 6.0d0                                                         
       b_(i,3) = 3.464101615137755d0                                           
       b_(i,4) = 4.898979485566356d1*r-1.959591794226543d1                     
       b_(i,5) = 4.242640687119285d1*s+4.242640687119285d1*r
     1    -2.545584412271571d1                                                             
       b_(i,6) = 3.286335345030997d1*s+1.095445115010332d1*r
     1    -1.095445115010332d1                                                             
       b_(i,7) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1    +4.242640687119285d1                                                       
       b_(i,8) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1    -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2    -9.699979381421385d2)+1.910601999370879d2)                                        
       b_(i,9) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1    -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2    -1.897366596101028d2)+5.692099788303083d1                                         
       b_(i,10) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1    r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2    -4.48998886412873d1)+2.244994432064365d1                                         
       b_(i,11) = r*(r*(1.593787940724863d3*r        
     1    -2.125050587633151d3)+7.968939703624316d2)-7.58946638440411d1                       
       b_(i,12) = (r*(2.760521689826037d3*r        
     1    -1.840347793217358d3)+2.300434741521698d2)*s+r*(r        
     2    *(1.840347793217358d3*r-2.760521689826037d3)
     3    +1.150217370760849d3)-1.204989626511366d2                                                                
       b_(i,13) = 2.5d-1*(s*((1.221880517890354d4*r
     &      -2.71529        
     1    0039756342d3)*s+r*(1.832820776835531d4*r-1.7649385258416        
     2    22d4)+2.884995667241114d3)+r*(r*(4.072935059634513        
     3    d3*r-7.467047609329941d3)+3.903229432149742d3)-5.0911688245431        
     4    42d2)                                                                 
       b_(i,14) = s*(s*(1.505988047761336d3*s+4.51796414328        
     1    4008d3*r-2.509980079602227d3)+r*(2.710778485970405d3*r-3        
     2    .815169720995385d3)+1.10439123502498d3)+r*(r*(3.01        
     3    1976095522672d2*r-7.027944222886235d2)+5.019960159204453d2)-1.        
     4    003992031840891d2                                                     
       b_(i,15) = 2.0d-1*(s*(s*(6.640783086353596d3*s+8.538        
     1    149682454624d3*r-8.538149682454624d3)+r*(2.8460498941515        
     2    41d3*r-5.692099788303083d3)+2.846049894151541d3)+r*(1.0d        
     3    0*r*(1.897366596101028d2*r-5.692099788303083d2)+5.692099788303        
     4    083d2)-1.897366596101028d2)                                           
       b_(i,16) = 3.333333333333333d-1*(r*(r*(r*(2.40        
     1    0622419290464d4*r-4.364768035073571d4)+2.618860821044143d4)-5.        
     2    819690713431428d3)+3.637306695894642d2)                               
       b_(i,17) = (r*(r*(1.584d4*r-1.728d4)+5.184d3)-        
     1    3.84d2)*s+r*(r*(r*(9.9d3*r-1.944d4)+1.2528d4        
     2    )-2.976d3)+1.98d2                                                     
       b_(i,18) = 6.666666666666667d-2*(s*((r*(3.4508        
     1    28161470809d5*r-1.882269906256805d5)+1.882269906256805d4)*s+1.        
     2    0d0*r*(r*(4.601104215294411d5*r-6.274233020856016d5)+2.2        
     3    58723887508166d5)-1.951983606488538d4)+r*(r*(        
     4    r*(9.585633781863357d4*r-2.161124707183739d5)+1.6103864753530        
     5    44d5)-4.415201014676455d4)+3.369495511200453d3)                       
       b_(i,19) = s*(s*((2.01633330578057d4*r-3.66606        
     1    0555964672d3)*s+r*(4.536749938006282d4*r-4.1243181254602        
     2    56d4)+5.774045375644359d3)+r*(r*(2.419599966936684        
     3    d4*r-4.289290850478666d4)+2.111650880235651d4)-2.4195999669366        
     4    84d3)+r*(r*(r*(2.520416632225712d3*r-6.78221        
     5    2028534643d3)+6.213972642360119d3)-2.162975728019157d3)+2.1079        
     6    84819679686d2                                                         
       b_(i,20) = s*(s*(s*(8.002074730968213d3*s+3.20        
     1    0829892387285d4*r-1.745907214029428d4)+r*(3.086514539087        
     2    74d4*r-4.302414206001092d4)+1.215899666913352d4)+r*(
     3    r*(9.145228263963672d3*r-2.120030188464306d4)+1.496491897739        
     4    51d4)-2.909845356715714d3)+r*(r*(r*(5.715767        
     5    664977295d2*r-1.870614872174388d3)+2.182384017536786d3)-1.0392        
     6    30484541326d3)+1.55884572681199d2                                     
       b_(i,21) = s*(s*(s*(7.238148934637916d3*s+1.28        
     1    6782032824518d4*r-1.286782032824518d4)+r*(7.238148934637        
     2    916d3*r-1.447629786927583d4)+7.238148934637916d3)+r*(1.0        
     3    d0*r*(1.378695035169127d3*r-4.136085105507381d3)+4.13608510550        
     4    7381d3)-1.378695035169127d3)+r*(r*(r*(5.7445        
     5    62646538029d1*r-2.297825058615211d2)+3.446737587922817d2)-2.29        
     6    7825058615211d2)+5.744562646538029d1                                  




         else if (trb_.eq.'N') then 


       b_(1,i) = 0.0d0                                                         
       b_(2,i) = 6.0d0                                                         
       b_(3,i) = 3.464101615137755d0                                           
       b_(4,i) = 4.898979485566356d1*r-1.959591794226543d1                     
       b_(5,i) = 4.242640687119285d1*s+4.242640687119285d1*r
     1    -2.545584412271571d1                                                             
       b_(6,i) = 3.286335345030997d1*s+1.095445115010332d1*r
     1    -1.095445115010332d1                                                             
       b_(7,i) = r*(2.9698484809835d2*r-2.545584412271571d2)        
     1    +4.242640687119285d1                                                       
       b_(8,i) = 3.333333333333333d-1*((1.234542830362722d3*r        
     1    -3.527265229607776d2)*s+r*(9.259071227720413d2*r        
     2    -9.699979381421385d2)+1.910601999370879d2)                                        
       b_(9,i) = s*(2.656313234541439d2*s+5.312626469082877d2*r        
     1    -3.035786553761644d2)+r*(1.328156617270719d2*r        
     2    -1.897366596101028d2)+5.692099788303083d1                                         
       b_(10,i) = s*(2.244994432064365d2*s+1.795995545651492d2*        
     1    r-1.795995545651492d2)+r*(2.244994432064365d1*r        
     2    -4.48998886412873d1)+2.244994432064365d1                                         
       b_(11,i) = r*(r*(1.593787940724863d3*r        
     1    -2.125050587633151d3)+7.968939703624316d2)-7.58946638440411d1                       
       b_(12,i) = (r*(2.760521689826037d3*r        
     1    -1.840347793217358d3)+2.300434741521698d2)*s+r*(r        
     2    *(1.840347793217358d3*r-2.760521689826037d3)
     3    +1.150217370760849d3)-1.204989626511366d2                                                                
       b_(13,i) = 2.5d-1*(s*((1.221880517890354d4*r
     &      -2.71529        
     1    0039756342d3)*s+r*(1.832820776835531d4*r-1.7649385258416        
     2    22d4)+2.884995667241114d3)+r*(r*(4.072935059634513        
     3    d3*r-7.467047609329941d3)+3.903229432149742d3)-5.0911688245431        
     4    42d2)                                                                 
       b_(14,i) = s*(s*(1.505988047761336d3*s+4.51796414328        
     1    4008d3*r-2.509980079602227d3)+r*(2.710778485970405d3*r-3        
     2    .815169720995385d3)+1.10439123502498d3)+r*(r*(3.01        
     3    1976095522672d2*r-7.027944222886235d2)+5.019960159204453d2)-1.        
     4    003992031840891d2                                                     
       b_(15,i) = 2.0d-1*(s*(s*(6.640783086353596d3*s+8.538        
     1    149682454624d3*r-8.538149682454624d3)+r*(2.8460498941515        
     2    41d3*r-5.692099788303083d3)+2.846049894151541d3)+r*(1.0d        
     3    0*r*(1.897366596101028d2*r-5.692099788303083d2)+5.692099788303        
     4    083d2)-1.897366596101028d2)                                           
       b_(16,i) = 3.333333333333333d-1*(r*(r*(r*(2.40        
     1    0622419290464d4*r-4.364768035073571d4)+2.618860821044143d4)-5.        
     2    819690713431428d3)+3.637306695894642d2)                               
       b_(17,i) = (r*(r*(1.584d4*r-1.728d4)+5.184d3)-        
     1    3.84d2)*s+r*(r*(r*(9.9d3*r-1.944d4)+1.2528d4        
     2    )-2.976d3)+1.98d2                                                     
       b_(18,i) = 6.666666666666667d-2*(s*((r*(3.4508        
     1    28161470809d5*r-1.882269906256805d5)+1.882269906256805d4)*s+1.        
     2    0d0*r*(r*(4.601104215294411d5*r-6.274233020856016d5)+2.2        
     3    58723887508166d5)-1.951983606488538d4)+r*(r*(        
     4    r*(9.585633781863357d4*r-2.161124707183739d5)+1.6103864753530        
     5    44d5)-4.415201014676455d4)+3.369495511200453d3)                       
       b_(19,i) = s*(s*((2.01633330578057d4*r-3.66606        
     1    0555964672d3)*s+r*(4.536749938006282d4*r-4.1243181254602        
     2    56d4)+5.774045375644359d3)+r*(r*(2.419599966936684        
     3    d4*r-4.289290850478666d4)+2.111650880235651d4)-2.4195999669366        
     4    84d3)+r*(r*(r*(2.520416632225712d3*r-6.78221        
     5    2028534643d3)+6.213972642360119d3)-2.162975728019157d3)+2.1079        
     6    84819679686d2                                                         
       b_(20,i) = s*(s*(s*(8.002074730968213d3*s+3.20        
     1    0829892387285d4*r-1.745907214029428d4)+r*(3.086514539087        
     2    74d4*r-4.302414206001092d4)+1.215899666913352d4)+r*(
     3    r*(9.145228263963672d3*r-2.120030188464306d4)+1.496491897739        
     4    51d4)-2.909845356715714d3)+r*(r*(r*(5.715767        
     5    664977295d2*r-1.870614872174388d3)+2.182384017536786d3)-1.0392        
     6    30484541326d3)+1.55884572681199d2                                     
       b_(21,i) = s*(s*(s*(7.238148934637916d3*s+1.28        
     1    6782032824518d4*r-1.286782032824518d4)+r*(7.238148934637        
     2    916d3*r-1.447629786927583d4)+7.238148934637916d3)+r*(1.0        
     3    d0*r*(1.378695035169127d3*r-4.136085105507381d3)+4.13608510550        
     4    7381d3)-1.378695035169127d3)+r*(r*(r*(5.7445        
     5    62646538029d1*r-2.297825058615211d2)+3.446737587922817d2)-2.29        
     6    7825058615211d2)+5.744562646538029d1                                  




         endif
      end do
      end subroutine       
      







    
      
      subroutine ensBASIS_TRIA_DSORTHO0(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
            b_(i,1) = 0.d0
         else if (trb_.eq.'N') then 
            b_(1,i) = 0.d0
         endif
      end do
      end subroutine       

      subroutine ensBASIS_TRIA_DSORTHO1(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 0.0d0                                                         
         b_(i,3) = 6.928203230275509d0                                           
         else if (trb_.eq.'N') then 
         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 0.0d0                                                         
         b_(3,i) = 6.928203230275509d0                                           
         endif
      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DSORTHO2(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
       b_(i,1) = 0.0d0                                                         
       b_(i,2) = 0.0d0                                                         
       b_(i,3) = 6.928203230275509d0                                           
       b_(i,4) = 0.0d0                                                         
       b_(i,5) = 4.242640687119285d1*r-8.48528137423857d0                      
       b_(i,6) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1    -3.286335345030997d1                                                             
         else if (trb_.eq.'N') then 

       b_(1,i) = 0.0d0                                                         
       b_(2,i) = 0.0d0                                                         
       b_(3,i) = 6.928203230275509d0                                           
       b_(4,i) = 0.0d0                                                         
       b_(5,i) = 4.242640687119285d1*r-8.48528137423857d0                      
       b_(6,i) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1    -3.286335345030997d1                                                             
         endif

      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DSORTHO3(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 

         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 0.0d0                                                         
         b_(i,3) = 6.928203230275509d0                                           
         b_(i,4) = 0.0d0                                                         
         b_(i,5) = 4.242640687119285d1*r-8.48528137423857d0                      
         b_(i,6) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1        -3.286335345030997d1                                                             
         b_(i,7) = 0.0d0                                                         
         b_(i,8) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1        .527265229607776d2)+2.939387691339814d1)                              
         b_(i,9) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1        d0*r*(2.656313234541439d2*r-3.035786553761644d2)        
     2        +3.794733192202055d1                                                                
         b_(i,10) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1        48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2        1492d2)+8.979977728257459d1                                           
         




      else         if (trb_.eq.'N') then 


         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 0.0d0                                                         
         b_(3,i) = 6.928203230275509d0                                           
         b_(4,i) = 0.0d0                                                         
         b_(5,i) = 4.242640687119285d1*r-8.48528137423857d0                      
         b_(6,i) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1        -3.286335345030997d1                                                             
         b_(7,i) = 0.0d0                                                         
         b_(8,i) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1        .527265229607776d2)+2.939387691339814d1)                              
         b_(9,i) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1        d0*r*(2.656313234541439d2*r-3.035786553761644d2)        
     2        +3.794733192202055d1                                                                
         b_(10,i) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1        48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2        1492d2)+8.979977728257459d1                                           
         




      endif




      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DSORTHO4(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 


         b_(i,1) = 0.0d0                                                         
         b_(i,2) = 0.0d0                                                         
         b_(i,3) = 6.928203230275509d0                                           
         b_(i,4) = 0.0d0                                                         
         b_(i,5) = 4.242640687119285d1*r-8.48528137423857d0                      
         b_(i,6) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1        -3.286335345030997d1                                                             
         b_(i,7) = 0.0d0                                                         
         b_(i,8) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1        .527265229607776d2)+2.939387691339814d1)                              
         b_(i,9) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1        d0*r*(2.656313234541439d2*r-3.035786553761644d2)        
     2        +3.794733192202055d1                                                                
         b_(i,10) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1        48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2        1492d2)+8.979977728257459d1                                           
         b_(i,11) = 0.0d0                                                        
         b_(i,12) = r*(r*(9.201738966086791d2*r-9.20173896608        
     1        6791d2)+2.300434741521698d2)-1.095445115010332d1                      
         b_(i,13) = 2.5d-1*((r*(1.221880517890354d4*r-5.43058        
     1        0079512684d3)+3.394112549695428d2)*s+r*(r*(6.10940        
     2        258945177d3*r-8.824692629208112d3)+2.884995667241114d3)        
     3        -1.697056274847714d2)                                                        
         b_(i,14) = s*((4.517964143284008d3*r-5.0199601592044        
     1        53d2)*s+r*(4.517964143284008d3*r-5.019960159204453d3)+5.        
     2        019960159204453d2)+r*(r*(9.035928286568016d2*r-1.9        
     3        07584860497692d3)+1.10439123502498d3)-1.003992031840891d2             
         b_(i,15) = s*(s*(2.656313234541439d3*s+3.98446985181        
     1        2158d3*r-3.984469851812158d3)+r*(1.707629936490925d3*r-3        
     2        .41525987298185d3)+1.707629936490925d3)+r*(r*(1.89        
     3        7366596101028d2*r-5.692099788303083d2)        
     4        +5.692099788303083d2)-1.897366596101028d2                                                     
         



         




      else          if (trb_.eq.'N') then 

         b_(1,i) = 0.0d0                                                         
         b_(2,i) = 0.0d0                                                         
         b_(3,i) = 6.928203230275509d0                                           
         b_(4,i) = 0.0d0                                                         
         b_(5,i) = 4.242640687119285d1*r-8.48528137423857d0                      
         b_(6,i) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1        -3.286335345030997d1                                                             
         b_(7,i) = 0.0d0                                                         
         b_(8,i) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1        .527265229607776d2)+2.939387691339814d1)                              
         b_(9,i) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1        d0*r*(2.656313234541439d2*r-3.035786553761644d2)        
     2        +3.794733192202055d1                                                                
         b_(10,i) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1        48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2        1492d2)+8.979977728257459d1                                           
         b_(11,i) = 0.0d0                                                        
         b_(12,i) = r*(r*(9.201738966086791d2*r-9.20173896608        
     1        6791d2)+2.300434741521698d2)-1.095445115010332d1                      
         b_(13,i) = 2.5d-1*((r*(1.221880517890354d4*r-5.43058        
     1        0079512684d3)+3.394112549695428d2)*s+r*(r*(6.10940        
     2        258945177d3*r-8.824692629208112d3)+2.884995667241114d3)        
     3        -1.697056274847714d2)                                                        
         b_(14,i) = s*((4.517964143284008d3*r-5.0199601592044        
     1        53d2)*s+r*(4.517964143284008d3*r-5.019960159204453d3)+5.        
     2        019960159204453d2)+r*(r*(9.035928286568016d2*r-1.9        
     3        07584860497692d3)+1.10439123502498d3)-1.003992031840891d2             
         b_(15,i) = s*(s*(2.656313234541439d3*s+3.98446985181        
     1        2158d3*r-3.984469851812158d3)+r*(1.707629936490925d3*r-3        
     2        .41525987298185d3)+1.707629936490925d3)+r*(r*(1.89        
     3        7366596101028d2*r-5.692099788303083d2)        
     4        +5.692099788303083d2)-1.897366596101028d2                                                     
         



         





      endif


      end do
      end subroutine       
      subroutine ensBASIS_TRIA_DSORTHO5(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)

      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 


       b_(i,1) = 0.0d0                                                         
       b_(i,2) = 0.0d0                                                         
       b_(i,3) = 6.928203230275509d0                                           
       b_(i,4) = 0.0d0                                                         
       b_(i,5) = 4.242640687119285d1*r-8.48528137423857d0                      
       b_(i,6) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1    -3.286335345030997d1                                                             
       b_(i,7) = 0.0d0                                                         
       b_(i,8) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1    .527265229607776d2)+2.939387691339814d1)                              
       b_(i,9) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1    d0*r*(2.656313234541439d2*r-3.035786553761644d2)+3.79473319220        
     2    2055d1                                                                
       b_(i,10) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1    48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2    1492d2)+8.979977728257459d1                                           
       b_(i,11) = 0.0d0                                                        
       b_(i,12) = r*(r*(9.201738966086791d2*r-9.20173896608        
     1    6791d2)+2.300434741521698d2)-1.095445115010332d1                      
       b_(i,13) = 2.5d-1*((r*(1.221880517890354d4*r-5.43058        
     1    0079512684d3)+3.394112549695428d2)*s+r*(r*(6.10940        
     2    258945177d3*r-8.824692629208112d3)+2.884995667241114d3)-1.6970        
     3    56274847714d2)                                                        
       b_(i,14) = s*((4.517964143284008d3*r-5.0199601592044        
     1    53d2)*s+r*(4.517964143284008d3*r-5.019960159204453d3)+5.        
     2    019960159204453d2)+r*(r*(9.035928286568016d2*r-1.9        
     3    07584860497692d3)+1.10439123502498d3)-1.003992031840891d2             
       b_(i,15) = s*(s*(2.656313234541439d3*s+3.98446985181        
     1    2158d3*r-3.984469851812158d3)+r*(1.707629936490925d3*r-3        
     2    .41525987298185d3)+1.707629936490925d3)+r*(r*(1.89        
     3    7366596101028d2*r-5.692099788303083d2)+5.692099788303083d2)-1.        
     4    897366596101028d2                                                     
       b_(i,16) = 0.0d0                                                        
       b_(i,17) = r*(r*(r*(3.96d3*r-5.76d3)+2.592d3)-        
     1    3.84d2)+1.2d1                                                         
       b_(i,18) = 2.0d-1*((r*(r*(7.668507025490686d4*        
     1    r-6.274233020856016d4)+1.254846604171203d4)-4.6475800154489d2)        
     2    *s+r*(r*(r*(3.834253512745343d4*r-6.97137002        
     3    3173351d4)+3.764539812513609d4)-6.506612021628461d3)+2.3237900        
     4    0772445d2)                                                            
       b_(i,19) = s*((r*(3.024499958670854d4*r-1.0998        
     1    18166789402d4)+5.499090833947008d2)*s+r*(r*(3.0244        
     2    99958670854d4*r-4.124318125460256d4)+1.154809075128872d4)-5.49        
     3    9090833947008d2)+r*(r*(r*(6.048999917341709d        
     4    3*r-1.429763616826222d4)+1.055825440117826d4)-2.41959996693668        
     5    4d3)+1.099818166789402d2                                              
       b_(i,20) = s*(s*((3.200829892387285d4*r-2.9098        
     1    45356715714d3)*s+r*(4.801244838580928d4*r-5.237721642088        
     2    285d4)+4.364768035073571d3)+r*(r*(2.05767635939182        
     3    6d4*r-4.302414206001092d4)+2.431799333826704d4)-1.870614872174        
     4    388d3)+r*(r*(r*(2.286307065990918d3*r-7.0667        
     5    6729488102d3)+7.482459488697551d3)-2.909845356715714d3)+2.0784        
     6    60969082653d2                                                         
       b_(i,21) = s*(s*(s*(1.447629786927583d4*s+2.89        
     1    5259573855166d4*r-2.895259573855166d4)+r*(1.930173049236        
     2    778d4*r-3.860346098473555d4)+1.930173049236778d4)+r*(1.0        
     3    d0*r*(4.825432623091944d3*r-1.447629786927583d4)+1.44762978692        
     4    7583d4)-4.825432623091944d3)+r*(r*(r*(3.4467        
     5    37587922817d2*r-1.378695035169127d3)+2.06804255275369d3)-1.378        
     6    695035169127d3)+3.446737587922817d2                                   








         else if (trb_.eq.'N') then 

       b_(1,i) = 0.0d0                                                         
       b_(2,i) = 0.0d0                                                         
       b_(3,i) = 6.928203230275509d0                                           
       b_(4,i) = 0.0d0                                                         
       b_(5,i) = 4.242640687119285d1*r-8.48528137423857d0                      
       b_(6,i) = 6.572670690061993d1*s+3.286335345030997d1*r        
     1    -3.286335345030997d1                                                             
       b_(7,i) = 0.0d0                                                         
       b_(8,i) = 3.333333333333333d-1*(r*(6.172714151813609d2*r-3        
     1    .527265229607776d2)+2.939387691339814d1)                              
       b_(9,i) = (5.312626469082877d2*r-7.58946638440411d1)*s+1.0        
     1    d0*r*(2.656313234541439d2*r-3.035786553761644d2)+3.79473319220        
     2    2055d1                                                                
       b_(10,i) = s*(4.48998886412873d2*s+4.48998886412873d2*r-4.        
     1    48998886412873d2)+r*(8.979977728257459d1*r-1.79599554565        
     2    1492d2)+8.979977728257459d1                                           
       b_(11,i) = 0.0d0                                                        
       b_(12,i) = r*(r*(9.201738966086791d2*r-9.20173896608        
     1    6791d2)+2.300434741521698d2)-1.095445115010332d1                      
       b_(13,i) = 2.5d-1*((r*(1.221880517890354d4*r-5.43058        
     1    0079512684d3)+3.394112549695428d2)*s+r*(r*(6.10940        
     2    258945177d3*r-8.824692629208112d3)+2.884995667241114d3)-1.6970        
     3    56274847714d2)                                                        
       b_(14,i) = s*((4.517964143284008d3*r-5.0199601592044        
     1    53d2)*s+r*(4.517964143284008d3*r-5.019960159204453d3)+5.        
     2    019960159204453d2)+r*(r*(9.035928286568016d2*r-1.9        
     3    07584860497692d3)+1.10439123502498d3)-1.003992031840891d2             
       b_(15,i) = s*(s*(2.656313234541439d3*s+3.98446985181        
     1    2158d3*r-3.984469851812158d3)+r*(1.707629936490925d3*r-3        
     2    .41525987298185d3)+1.707629936490925d3)+r*(r*(1.89        
     3    7366596101028d2*r-5.692099788303083d2)+5.692099788303083d2)-1.        
     4    897366596101028d2                                                     
       b_(16,i) = 0.0d0                                                        
       b_(17,i) = r*(r*(r*(3.96d3*r-5.76d3)+2.592d3)-        
     1    3.84d2)+1.2d1                                                         
       b_(18,i) = 2.0d-1*((r*(r*(7.668507025490686d4*        
     1    r-6.274233020856016d4)+1.254846604171203d4)-4.6475800154489d2)        
     2    *s+r*(r*(r*(3.834253512745343d4*r-6.97137002        
     3    3173351d4)+3.764539812513609d4)-6.506612021628461d3)+2.3237900        
     4    0772445d2)                                                            
       b_(19,i) = s*((r*(3.024499958670854d4*r-1.0998        
     1    18166789402d4)+5.499090833947008d2)*s+r*(r*(3.0244        
     2    99958670854d4*r-4.124318125460256d4)+1.154809075128872d4)-5.49        
     3    9090833947008d2)+r*(r*(r*(6.048999917341709d        
     4    3*r-1.429763616826222d4)+1.055825440117826d4)-2.41959996693668        
     5    4d3)+1.099818166789402d2                                              
       b_(20,i) = s*(s*((3.200829892387285d4*r-2.9098        
     1    45356715714d3)*s+r*(4.801244838580928d4*r-5.237721642088        
     2    285d4)+4.364768035073571d3)+r*(r*(2.05767635939182        
     3    6d4*r-4.302414206001092d4)+2.431799333826704d4)-1.870614872174        
     4    388d3)+r*(r*(r*(2.286307065990918d3*r-7.0667        
     5    6729488102d3)+7.482459488697551d3)-2.909845356715714d3)+2.0784        
     6    60969082653d2                                                         
       b_(21,i) = s*(s*(s*(1.447629786927583d4*s+2.89        
     1    5259573855166d4*r-2.895259573855166d4)+r*(1.930173049236        
     2    778d4*r-3.860346098473555d4)+1.930173049236778d4)+r*(1.0        
     3    d0*r*(4.825432623091944d3*r-1.447629786927583d4)+1.44762978692        
     4    7583d4)-4.825432623091944d3)+r*(r*(r*(3.4467        
     5    37587922817d2*r-1.378695035169127d3)+2.06804255275369d3)-1.378        
     6    695035169127d3)+3.446737587922817d2                                   








         endif
      end do
      end subroutine       
      







    


      
      subroutine ensBASIS_TRIA_ORTHO0(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
            b_(i,1) = 1.414213562373095d0                                             
         else if (trb_.eq.'N') then 
            b_(1,i) = 1.414213562373095d0                                             
         endif
      end do
      end subroutine       

      subroutine ensBASIS_TRIA_ORTHO1(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 1.414213562373095d0                                             
         b_(i,2) = 6.0d0*r-2.0d0                                                   
         b_(i,3) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                                                
         else if (trb_.eq.'N') then 
         b_(1,i) = 1.414213562373095d0                                             
         b_(2,i) = 6.0d0*r-2.0d0                                                   
         b_(3,i) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                                                
         endif
      end do
      end subroutine       
      subroutine ensBASIS_TRIA_ORTHO2(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)
      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 1.414213562373095d0                                             
         b_(i,2) = 6.0d0*r-2.0d0                                                   
         b_(i,3) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(i,4) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(i,5) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s
     &        +r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(i,6) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         else if (trb_.eq.'N') then 
         b_(1,i) = 1.414213562373095d0                                             
         b_(2,i) = 6.0d0*r-2.0d0                                                   
         b_(3,i) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(4,i) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(5,i) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s
     &        +r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(6,i) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         endif

      end do
      end subroutine       
      subroutine ensBASIS_TRIA_ORTHO3(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 1.414213562373095d0                                             
         b_(i,2) = 6.0d0*r-2.0d0                                                   
         b_(i,3) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(i,4) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(i,5) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(i,6) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(i,7) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(i,8) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(i,9) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(i,10) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
      else         if (trb_.eq.'N') then 
         b_(1,i) = 1.414213562373095d0                                             
         b_(2,i) = 6.0d0*r-2.0d0                                                   
         b_(3,i) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(4,i) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(5,i) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(6,i) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(7,i) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(8,i) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(9,i) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(10,i) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
      endif




      end do
      end subroutine       
      subroutine ensBASIS_TRIA_ORTHO4(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)


      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 1.414213562373095d0                                             
         b_(i,2) = 6.0d0*r-2.0d0                                                   
         b_(i,3) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(i,4) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(i,5) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(i,6) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(i,7) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(i,8) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(i,9) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(i,10) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
         b_(i,11) = r*(r*(r*(3.984469851812158d2*r-7.0835        
     1        0195877717d2)+3.984469851812158d2)-7.58946638440411d1)
     2        +3.162277660168379d0                                                          
         b_(i,12) = (r*(r*(9.201738966086791d2*r-9.201738        
     1        966086791d2)+2.300434741521698d2)-1.095445115010332d1)*s
     2        +r*(r*(r*(4.600869483043395d2*r-9.201738966086791d        
     3        2)+5.751086853804244d2)-1.204989626511366d2)        
     4        +5.477225575051661d0                                                                    
         b_(i,13) = 1.25d-1*(s*((r*(1.221880517890354d4*r        
     1        -5.430580079512684d3)+3.394112549695428d2)*s+r*(r*        
     2        (1.221880517890354d4*r-1.764938525841622d4)        
     3        +5.769991334482227d3)-3.394112549695428d2)+r*(r*(r*(        
     4        2.036467529817257d3*r-4.978031739553294d3)
     &        +3.903229432149742d3)-1.018233764908628d3)
     &        +5.65685424949238d1)                                       
         b_(i,14) = s*(s*((1.505988047761336d3*r-1.673320        
     1        053068151d2)*s+r*(2.258982071642004d3*r-2.50998007960222        
     2        7d3)+2.509980079602227d2)+r*(r*(9.035928286568016d        
     3        2*r-1.907584860497692d3)+1.10439123502498d3)
     4        -1.003992031840891d2)+r*(r*(r*(7.52994023880668d1*r        
     5        -2.342648074295412d2)+2.509980079602227d2)        
     6        -1.003992031840891d2)+8.366600265340756d0                                                            
         b_(i,15) = 1.0d-1*(s*(s*(s*(6.640783086353596d3*        
     1        s+1.328156617270719d4*r-1.328156617270719d4)+r*(8.538149        
     2        682454624d3*r-1.707629936490925d4)+8.538149682454624d3)+        
     3        r*(r*(1.897366596101028d3*r-5.692099788303083d3)+5.69209        
     4        9788303083d3)-1.897366596101028d3)+r*(r*(r*(        
     5        9.486832980505138d1*r-3.794733192202055d2)
     &        +5.692099788303083d2        
     6        )-3.794733192202055d2)+9.486832980505138d1)                           
      else          if (trb_.eq.'N') then 
         b_(1,i) = 1.414213562373095d0                                             
         b_(2,i) = 6.0d0*r-2.0d0                                                   
         b_(3,i) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(4,i) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(5,i) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(6,i) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(7,i) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(8,i) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(9,i) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(10,i) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
         b_(11,i) = r*(r*(r*(3.984469851812158d2*r-7.0835        
     1        0195877717d2)+3.984469851812158d2)-7.58946638440411d1)
     2        +3.162277660168379d0                                                          
         b_(12,i) = (r*(r*(9.201738966086791d2*r-9.201738        
     1        966086791d2)+2.300434741521698d2)-1.095445115010332d1)*s
     2        +r*(r*(r*(4.600869483043395d2*r-9.201738966086791d        
     3        2)+5.751086853804244d2)-1.204989626511366d2)        
     4        +5.477225575051661d0                                                                    
         b_(13,i) = 1.25d-1*(s*((r*(1.221880517890354d4*r        
     1        -5.430580079512684d3)+3.394112549695428d2)*s+r*(r*        
     2        (1.221880517890354d4*r-1.764938525841622d4)        
     3        +5.769991334482227d3)-3.394112549695428d2)+r*(r*(r*(        
     4        2.036467529817257d3*r-4.978031739553294d3)
     &        +3.903229432149742d3)-1.018233764908628d3)
     &        +5.65685424949238d1)                                       
         b_(14,i) = s*(s*((1.505988047761336d3*r-1.673320        
     1        053068151d2)*s+r*(2.258982071642004d3*r-2.50998007960222        
     2        7d3)+2.509980079602227d2)+r*(r*(9.035928286568016d        
     3        2*r-1.907584860497692d3)+1.10439123502498d3)
     4        -1.003992031840891d2)+r*(r*(r*(7.52994023880668d1*r        
     5        -2.342648074295412d2)+2.509980079602227d2)        
     6        -1.003992031840891d2)+8.366600265340756d0                                                            
         b_(15,i) = 1.0d-1*(s*(s*(s*(6.640783086353596d3*        
     1        s+1.328156617270719d4*r-1.328156617270719d4)+r*(8.538149        
     2        682454624d3*r-1.707629936490925d4)+8.538149682454624d3)+        
     3        r*(r*(1.897366596101028d3*r-5.692099788303083d3)+5.69209        
     4        9788303083d3)-1.897366596101028d3)+r*(r*(r*(        
     5        9.486832980505138d1*r-3.794733192202055d2)
     &        +5.692099788303083d2        
     6        )-3.794733192202055d2)+9.486832980505138d1)                           
      endif




      end do
      end subroutine       
      subroutine ensBASIS_TRIA_ORTHO5(trp_,trb_,n_,p_,poff_,b_,boff_)
      implicit none
      integer n_,poff_,boff_
      double precision b_(boff_,n_)
      double precision p_(poff_,n_)

      double precision r,s
      integer i
      character trp_,trb_
      do i=1,n_
         if (trp_.eq.'N') then 
            r = p_(1,i)
            s = p_(2,i)
         else  
            r = p_(i,1)
            s = p_(i,2)
         endif
         if (trb_.eq.'T') then 
         b_(i,1) = 1.414213562373095d0                                             
         b_(i,2) = 6.0d0*r-2.0d0                                                   
         b_(i,3) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(i,4) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(i,5) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(i,6) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(i,7) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(i,8) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(i,9) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(i,10) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
         b_(i,11) = r*(r*(r*(3.984469851812158d2*r-7.0835        
     1        0195877717d2)+3.984469851812158d2)-7.58946638440411d1)
     2       +3.162277660168379d0                                                          
         b_(i,12) = (r*(r*(9.201738966086791d2*r-9.201738        
     1        966086791d2)+2.300434741521698d2)-1.095445115010332d1)*s
     2        +r*(r*(r*(4.600869483043395d2*r-9.201738966086791d        
     3        2)+5.751086853804244d2)-1.204989626511366d2)
     4        +5.477225575051661d0                                                                    
         b_(i,13) = 1.25d-1*(s*((r*(1.221880517890354d4*r        
     1        -5.430580079512684d3)+3.394112549695428d2)*s+r*(r*        
     2        (1.221880517890354d4*r-1.764938525841622d4)
     3        +5.769991334482227d3)-3.394112549695428d2)+r*(r*(r*(
     4        2.036467529817257d3*r-4.978031739553294d3)
     5        +3.903229432149742d3)-1.018233764908628d3)
     6        +5.65685424949238d1)                                       
         b_(i,14) = s*(s*((1.505988047761336d3*r-1.673320        
     1        053068151d2)*s+r*(2.258982071642004d3*r-2.50998007960222        
     2        7d3)+2.509980079602227d2)+r*(r*(9.035928286568016d        
     3        2*r-1.907584860497692d3)+1.10439123502498d3)
     4        -1.003992031840891d2)+r*(r*(r*(7.52994023880668d1*r
     5        -2.342648074295412d2)+2.509980079602227d2)
     6        -1.003992031840891d2)+8.366600265340756d0                                                            
         b_(i,15) = 1.0d-1*(s*(s*(s*(6.640783086353596d3*        
     1        s+1.328156617270719d4*r-1.328156617270719d4)+r*(8.538149        
     2        682454624d3*r-1.707629936490925d4)+8.538149682454624d3)+        
     3        r*(r*(1.897366596101028d3*r-5.692099788303083d3)+5.69209        
     4        9788303083d3)-1.897366596101028d3)+r*(r*(r*(        
     5        9.486832980505138d1*r-3.794733192202055d2)
     6        +5.692099788303083d2)-3.794733192202055d2)
     7        +9.486832980505138d1)                           
         b_(i,16) = 3.333333333333333d-1*(r*(r*(r*(        
     1        r*(4.801244838580928d3*r-1.091192008768393d4)
     2        +8.729536070147142d3)-2.909845356715714d3)
     3        +3.637306695894642d2)-1.039230484541326d1)                                                                 
         b_(i,17) = (r*(r*(r*(3.96d3*r-5.76d3)+2.59        
     1        2d3)-3.84d2)+1.2d1)*s+r*(r*(r*(r*(1.98        
     2        d3*r-4.86d3)+4.176d3)-1.488d3)+1.98d2)-6.0d0                          
         b_(i,18) = 6.666666666666667d-2*(s*((r*(r*        
     1        (1.150276053823603d5*r-9.411349531284023d4)
     2        +1.882269906256805d4)-6.971370023173351d2)*s+r*(r*(r*
     3        (1.1502760        
     4        53823603d5*r-2.091411006952005d5)+1.129361943754083d5)        
     5        -1.951983606488538d4)+6.971370023173351d2)+r*(r*(r*(        
     6        r*(1.917126756372671d4*r-5.402811767959347d4)+5.36795491        
     7   784348d4)-2.207600507338228d4)+3.369495511200453d3)-1.16189500        
     8        3862225d2)                                                            
         b_(i,19) = s*(s*((r*(1.008166652890285d4*r        
     1        -3.666060555964672d3)+1.833030277982336d2)*s+r*(r*        
     2        (1.512249979335427d4*r-2.062159062730128d4)
     3 +5.774045375644359d3)-2.749545416973504d2)+r*(r*(r*(6.048999917        
     4   341709d3*r-1.429763616826222d4)+1.055825440117826d4)-2.4195999        
     5        66936684d3)+1.099818166789402d2)+r*(r*(r*(1.        
     6   0d0*r*(5.040833264451424d2*r-1.695553007133661d3)+2.0713242141        
     7   2004d3)-1.081487864009578d3)+2.107984819679686d2)-9.1651513899        
     8        1168d0                                                                
         b_(i,20) = s*(s*(s*((8.002074730968213d3*r        
     1        -7.274613391789285d2)*s+r*(1.600414946193643d4*r-1.74590        
     2        7214029428d4)+1.454922678357857d3)+r*(r*(1.0288381        
     3   79695913d4*r-2.151207103000546d4)+1.215899666913352d4)-9.35307        
     4        4360871938d2)+r*(r*(r*(2.286307065990918d3*r        
     5   -7.06676729488102d3)+7.482459488697551d3)-2.909845356715714d3)        
     6        +2.078460969082653d2)+r*(r*(r*(r*(1.14        
     7   3153532995459d2*r-4.676537180435969d2)+7.274613391789285d2)-5.        
     8        196152422706632d2)+1.55884572681199d2)-1.039230484541326d1            
         b_(i,21) = s*(s*(s*(s*(2.895259573855166d3        
     1        *s+7.238148934637916d3*r-7.238148934637916d3)+r*(6.43391        
     2        0164122592d3*r-1.286782032824518d4)+6.433910164122592d3)+
     3        r*(r*(2.412716311545972d3*r-7.238148934637916d3)+7.2381        
     4        48934637916d3)-2.412716311545972d3)+r*(r*(r*        
     5   (3.446737587922817d2*r-1.378695035169127d3)+2.06804255275369d3        
     6        )-1.378695035169127d3)+3.446737587922817d2)+r*(r*(        
     7        r*(r*(1.148912529307606d1*r-5.744562646538029d1)+1        
     8   .148912529307606d2)-1.148912529307606d2)+5.744562646538029d1)-        
     9        1.148912529307606d1                                                   
         else if (trb_.eq.'N') then 
         b_(1,i) = 1.414213562373095d0                                             
         b_(2,i) = 6.0d0*r-2.0d0                                                   
         b_(3,i) = 6.928203230275509d0*s+3.464101615137755d0*r
     &        -3.464101615137755d0                                                               
         b_(4,i) = r*(2.449489742783178d1*r-1.959591794226543d1)
     &        +2.449489742783178d0                                                       
         b_(5,i) = 5.0d-1*((8.48528137423857d1*r-1.697056274847714d1)*s+
     &        r*(4.242640687119285d1*r-5.091168824543142d1)
     &        +8.48528137423857d0)                                                          
         b_(6,i) = s*(3.286335345030997d1*s+3.286335345030997d1*r        
     &        -3.286335345030997d1)+r*(5.477225575051661d0*r        
     &        -1.095445115010332d1)+5.477225575051661d0                                           
         b_(7,i) = r*(r*(9.899494936611665d1*r-1.272792206135786d2)
     &        +4.242640687119285d1)-2.82842712474619d0                          
         b_(8,i) = 3.333333333333333d-1*((r*(6.172714151813609d2*r
     &        -3.527265229607776d2)+2.939387691339814d1)*s+r*(
     &        r*(3.086357075906804d2*r-4.849989690710693d2)
     &        +1.910601999370879d2)-1.469693845669907d1)                                            
         b_(9,i) = s*((2.656313234541439d2*r-3.794733192202055d        
     &        1)*s+r*(2.656313234541439d2*r-3.035786553761644d2)
     &        +3.794733192202055d1)+r*(r*(4.427188724235731d1*r
     &        -9.486832980505138d1)+5.692099788303083d1)
     &        -6.324555320336759d0               
         b_(10,i) = s*(s*(1.496662954709577d2*s+2.2449944320643        
     &        65d2*r-2.244994432064365d2)+r*(8.979977728257459d1*r        
     &        -1.795995545651492d2)+8.979977728257459d1)+r*(r*(        
     &        7.483314773547883d0*r-2.244994432064365d1)
     &        +2.244994432064365d1)-7.483314773547883d0
         b_(11,i) = r*(r*(r*(3.984469851812158d2*r-7.0835        
     1    0195877717d2)+3.984469851812158d2)-7.58946638440411d1)+3.16227        
     2        7660168379d0                                                          
         b_(12,i) = (r*(r*(9.201738966086791d2*r-9.201738        
     1        966086791d2)+2.300434741521698d2)-1.095445115010332d1)*s
     2        +r*(r*(r*(4.600869483043395d2*r-9.201738966086791d        
     3   2)+5.751086853804244d2)-1.204989626511366d2)+5.477225575051661        
     4        d0                                                                    
         b_(13,i) = 1.25d-1*(s*((r*(1.221880517890354d4*r        
     1    -5.430580079512684d3)+3.394112549695428d2)*s+r*(r*        
     2   (1.221880517890354d4*r-1.764938525841622d4)+5.769991334482227d        
     3      3)-3.394112549695428d2)+r*(r*(r*(2.036467529        
     4   817257d3*r-4.978031739553294d3)+3.903229432149742d3)-1.0182337        
     5        64908628d3)+5.65685424949238d1)                                       
         b_(14,i) = s*(s*((1.505988047761336d3*r-1.673320        
     1        053068151d2)*s+r*(2.258982071642004d3*r-2.50998007960222        
     2        7d3)+2.509980079602227d2)+r*(r*(9.035928286568016d        
     3   2*r-1.907584860497692d3)+1.10439123502498d3)-1.003992031840891        
     4        d2)+r*(r*(r*(7.52994023880668d1*r-2.34264807        
     5   4295412d2)+2.509980079602227d2)-1.003992031840891d2)+8.3666002        
     6        65340756d0                                                            
         b_(15,i) = 1.0d-1*(s*(s*(s*(6.640783086353596d3*        
     1        s+1.328156617270719d4*r-1.328156617270719d4)+r*(8.538149        
     2        682454624d3*r-1.707629936490925d4)+8.538149682454624d3)+        
     3        r*(r*(1.897366596101028d3*r-5.692099788303083d3)+5.69209        
     4        9788303083d3)-1.897366596101028d3)+r*(r*(r*(        
     5   9.486832980505138d1*r-3.794733192202055d2)+5.692099788303083d2        
     6        )-3.794733192202055d2)+9.486832980505138d1)                           
         b_(16,i) = 3.333333333333333d-1*(r*(r*(r*(        
     1   r*(4.801244838580928d3*r-1.091192008768393d4)+8.72953607014714        
     2   2d3)-2.909845356715714d3)+3.637306695894642d2)-1.0392304845413        
     3        26d1)                                                                 
         b_(17,i) = (r*(r*(r*(3.96d3*r-5.76d3)+2.59        
     1        2d3)-3.84d2)+1.2d1)*s+r*(r*(r*(r*(1.98        
     2        d3*r-4.86d3)+4.176d3)-1.488d3)+1.98d2)-6.0d0                          
         b_(18,i) = 6.666666666666667d-2*(s*((r*(r*        
     1   (1.150276053823603d5*r-9.411349531284023d4)+1.882269906256805d        
     2        4)-6.971370023173351d2)*s+r*(r*(r*(1.1502760        
     3   53823603d5*r-2.091411006952005d5)+1.129361943754083d5)-1.95198        
     4        3606488538d4)+6.971370023173351d2)+r*(r*(r*(        
     5        r*(1.917126756372671d4*r-5.402811767959347d4)+5.36795491        
     6   784348d4)-2.207600507338228d4)+3.369495511200453d3)-1.16189500        
     7        3862225d2)                                                            
         b_(19,i) = s*(s*((r*(1.008166652890285d4*r        
     1        -3.666060555964672d3)+1.833030277982336d2)*s+r*(r*        
     2        (1.512249979335427d4*r-2.062159062730128d4)
     3 +5.774045375644359d3)-2.749545416973504d2)+r*(r*(r*(6.048999917        
     4   341709d3*r-1.429763616826222d4)+1.055825440117826d4)-2.4195999        
     5        66936684d3)+1.099818166789402d2)+r*(r*(r*(1.        
     6   0d0*r*(5.040833264451424d2*r-1.695553007133661d3)+2.0713242141        
     7   2004d3)-1.081487864009578d3)+2.107984819679686d2)-9.1651513899        
     8        1168d0                                                                
         b_(20,i) = s*(s*(s*((8.002074730968213d3*r        
     1        -7.274613391789285d2)*s+r*(1.600414946193643d4*r-1.74590        
     2        7214029428d4)+1.454922678357857d3)+r*(r*(1.0288381        
     3   79695913d4*r-2.151207103000546d4)+1.215899666913352d4)-9.35307        
     4        4360871938d2)+r*(r*(r*(2.286307065990918d3*r        
     5   -7.06676729488102d3)+7.482459488697551d3)-2.909845356715714d3)        
     6        +2.078460969082653d2)+r*(r*(r*(r*(1.14        
     7   3153532995459d2*r-4.676537180435969d2)+7.274613391789285d2)-5.        
     8        196152422706632d2)+1.55884572681199d2)-1.039230484541326d1            
         b_(21,i) = s*(s*(s*(s*(2.895259573855166d3        
     1        *s+7.238148934637916d3*r-7.238148934637916d3)+r*(6.43391        
     2        0164122592d3*r-1.286782032824518d4)+6.433910164122592d3)+
     3        r*(r*(2.412716311545972d3*r-7.238148934637916d3)+7.2381        
     4        48934637916d3)-2.412716311545972d3)+r*(r*(r*        
     5   (3.446737587922817d2*r-1.378695035169127d3)+2.06804255275369d3        
     6        )-1.378695035169127d3)+3.446737587922817d2)+r*(r*(        
     7        r*(r*(1.148912529307606d1*r-5.744562646538029d1)+1        
     8   .148912529307606d2)-1.148912529307606d2)+5.744562646538029d1)-        
     9        1.148912529307606d1                                    
         endif
      end do
      end subroutine       
      
